# The following definition indicates the relative location of
# the core STK classes.


STK_PATH = $(BUILD_STK)/src/
INSTALL_DIR = $(INSTALL_PREFIX)/lib/pd/

INCLUDE = -I$(BUILD_STK)/include -Iexperimental -I$(BUILD_STK)/projects/ragamatic 

CXXDEFINES = -O3 -I. -D__OS_Linux_  -DSRATE=44100.0 -DRAWWAVE_PATH=\"$(INSTALL_DIR)\" $(INCLUDE)

CC_FILES = $(shell ls --ignore "*.tbl" --ignore "*.a" --ignore "*.o"  $(BUILD_STK)/src/)

CC_FILES += Sitar1.cpp StrDrone.cpp

O_FILES = $(CC_FILES:.cpp=.o)



%.o : $(STK_PATH)%.cpp
	$(CXX) $(CXXDEFINES) -c $(<) -o $@


%.o : $(STK_PATH)/../projects/ragamatic/%.cpp
	$(CXX) $(CXXDEFINES) -c $(<) -o $@


libstk:    $(O_FILES)
	ar rc libstk.a $(O_FILES)

.cpp.pd_linux: 
	$(CXX) -o $@ $(CFLAGS) $(LFLAGS) -O2 -DPD -fPIC $(INCLUDE) $*.cpp -L. -I$(STK_PATH) -lstk



clean::
	-rm libstk.a

install-stk::
	install -d $(DESTDIR)/$(INSTALL_DIR)/rawwaves
	install $(BUILD_STK)/rawwaves/* $(DESTDIR)/$(INSTALL_DIR)/rawwaves

